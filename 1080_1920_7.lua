--全民k歌刷鲜花脚本
--环境：雷电模拟器Android7.1(全民k歌专用版）：1080*1920
--最后更新时间：2020-04-26
--by wsxq2(wsxq2@qq.com)
--

--TODO: 判断是否滑到底部
require("TSLib")

--常用函数开始（或许应该单独放到一个文件里）
function click(x,y,r,t)
--	nLog("click: "..x.." "..y.." "..r.." "..t)
--	wLog("WeSingFlowers", "click: "..x.." "..y.." "..r.." "..t)
	randomTap(x,y,r)
	mSleep(math.random(t-500,t+500))
end

function click2s(x,y)
	click(x,y,10,2000)
end
function click3s(x,y)
	click(x,y,10,3000)
end
function click4s(x,y)
	click(x,y,10,4000)
end

function swipeBase(x1,y1,x2,y2,du)
--	nLog("swipeBase: "..x1..","..y1.." "..x2..","..y2.." "..du)
--	wLog("WeSingFlowers", "swipeBase: "..x1..","..y1.." "..x2..","..y2.." "..du)
	os.execute("input swipe "..x1.." "..y1.." "..x2.." "..y2.." "..du)
end

function swipe(x1,y1,x2,y2)
	swipeBase(x1,y1,x2,y2,300)
end

function swipe3s(x1,y1,x2,y2)
	swipe(x1,y1,x2,y2)
	mSleep(math.random(1000,2000))
end

function swipeDownWithDelta3s(delta)
	swipe(530, 1300, 530, 1300-delta)
	mSleep(math.random(3000,4000))
end

function swipeDownWithDeltaDu3s(delta,du)
	swipeBase(530, 1300, 530, 1300-delta,du)
	mSleep(math.random(1000,2000))
end

function swipeRightWithDelta3s(delta)
	swipe(700, 880, 700-delta, 880)
	mSleep(math.random(1000,2000))
end

--向下轻微滚动屏幕
function swipeDownLightly3s()
	swipeDownWithDelta3s(50)
end

--向下滚动屏幕
function swipeDown3s()
	swipeDownWithDelta3s(800)
end

--向右滚动屏幕
function swipeRight3s()
	swipeRightWithDelta3s(340)
end

--常用函数结束（或许应该单独放到一个文件里）


--进入任务中心
function enterRenWuZhongXin()
	local x,y
	x, y = tsFindText(addTSOcrDictEx(tab), "renwu", 47, 552, 397, 1601, "2A2A2A , 010101", 90)
	nLog("识别出的“任务中心”位置："..x..", "..y)
	wLog("WeSingFlowers", "识别出的“任务中心”位置："..x..", "..y)
	if x~=-1 and y~=-1 then
		click3s(x+100,y+deltaQianWang)
	else
		dialog("未识别到任务中心，请改善脚本或手动操作（在关闭本对话框后的 5 s内进行）")
		mSleep(5000)
		enterRenWuZhongXin()
	end
end

--退出任务中心
function exitRenWuZhongXin()
	backward()
end

--点击返回图标
function backward()
	click2s(72,150)
end

--点击关闭图标(签约直播间、欢唱歌房）
function clickClose()
	click3s(1020,80)
end

--点击广告视频左边的关闭图标
function clickCloseInGuangGao()
	click3s(105,90)
end

--查找文本
function findTextWithTabXYColor(tab,text, x1, y1, x2, y2,color)
--	nLog(text.." "..x1..","..y1.." "..x2..","..y2.." "..color)
--	wLog("WeSingFlowers", text.." "..x1..","..y1.." "..x2..","..y2.." "..color)
	return tsFindText(addTSOcrDictEx(tab), text, x1,y1,x2,y2, color, 90)
end

function findTextWithTabXColor(tab,text, x1, x2,color)
	return findTextWithTabXYColor(addTSOcrDictEx(tab), text, x1,222,x2,1750, color)
end

function findTextWithXYColor(text, x1, y1, x2, y2,color)
	return findTextWithTabXYColor(tab, text, x1,y1,x2,y2, color)
end

function findTextWithXColor(text,x1,x2,color)
	return findTextWithXYColor(text, x1, 222, x2, 1750, color)
end

function findTextWithColor(text,color)
	return findTextWithXColor(text, 235,385, color)
end

function findTextWithXY(text, x1, y1, x2, y2)
	return findTextWithXYColor(text,x1,y1,x2,y2,"2A2A2A , 010101")
end

--在任务中心的某个界面查找文本(给定两个横坐标）
function findTextWithX(text, x1,x2)
	return findTextWithXY(text,x1,222,x2,1750)
end

--在任务中心的某个界面查找文本
function findText(text)
	return findTextWithX(text,235,385) --x1:289
end

--判断 x,y 是否是“领取”二字的中心
function isLingQu(x,y)
	local tab = {
"0006000000001e00000000f870000003e0e020000f81c0e0007e0380e001f00701e00f8e0e01e0fe1e1c03e1f81e381ff3f81f707df0780ce3e1e07801ff80c07803fc00007c07e000003c070000003e080004003800001c0000000039c00000007387ffffc1c70fffff878e1fffff1e1c3800003838700001e070e0001f80ffc3fffe01ff9ffff803ff3fff10078e0000700e1c0000701c380000f038700000f070fffff8f0e1fffff0f1c3ffffe0f380000000e0000000008000000000000000000000000000000000000401e000000e03c000001c07fffffff80ffffffff01fffffffe03fffffff80781c0e0700f0381c0e01e070381c03c0e070780781c0e0e00f0381c1c01fffffffffbfffffffff7ffffffffefffffffffde000007003c00000e007800001c081e0000003c3c000000f07f000003e0fff0000781fffe003e03c7ff80f807807fc3e00f001fff801e0007fc003c0007f80078003ffc00f003fcfc01e03fe07c03c7ff007c07fff0007c0fff00007c0fc00000780000000070000000004$lingqu$1214$39$80",
	}
	x, y = tsFindText(addTSOcrDictEx(tab), "lingqu", x-100, y-100,x+100,y+100, "FFFFFF,010101", 90)
	return x~=-1 and y~=-1
end

--判断 x,y 是否是“前往”二字的中心
function isQianWang(x,y)
	local tab = {
		"03c000000007800000000f1ffffff81e3ffffff03c7fffffe078ffffffc0f1c3870061e3870e00f3c70e1c01f78e1c3811ff1c387039fe3870e070fc70e1c0e078e1c381c071c3870380e3ffffff01c7fffffe038ffffff807000000000e000000003c000000007800000000f000000001e3ffff0003c7fffe001f8ffffc30ff00000077fe000000efbc000001dc78000003b0f000000701e7fffffe03cffffffc079ffffff00f3fffffc01e000000003c0000000000000000000000000000000000000000000000000018000003803c00000700f000001e03c00000780f000001e03e00000780ffffff3e07fffffef81fffffffe07c00000781e0000004038000000006000007803c00000f007000001e00e00f003c01c01e007803803c00f007007801e00e00f003c01c01e007803803c00f707007801ef0f00f003dfffffffff8fffffffff0ffffffffe03f00f003c01c01e007803803c00f007007801e00e00f003c01c01e007803803c00f007007801e00e00f003c01c000007803800000f000000001e$qianwang$1147$39$80",
	}

	x, y = tsFindText(addTSOcrDictEx(tab), "qianwang", x-100, y-100,x+100,y+100, "FC1717 , 010101", 90)
	return x~=-1 and y~=-1
end

--点击“领取”，成功返回 true，失败返回 false
function clickLingQu(x,y)
	if isLingQu(x,y) then
		click2s(x,y)
		return true
	else
		nLog("（"..x..", "..y.."）处不是领取")
		wLog("WeSingFlowers", "（"..x..", "..y.."）处不是领取")
		return false
	end
end

--点击”前往“，成功返回 true，失败返回 false
function clickQianWang(ytmp)
	for j=1,3 do
		click3s(929,ytmp)
		if not isQianWang(929,ytmp) then
			return true
		end
	end
	return false
end

--在任务中心查找文本
function findTextInRWZXwithTabXYColor(tab, text, x1,y1,x2,y2,color)
	local x,y
	for i=1,5 do
		--		nLog(text)
		--		wLog("WeSingFlowers", text)
		--		x, y = findTextWithXColor(text,x1,x2,color)
		x,y= tsFindText(addTSOcrDictEx(tab), text, x1,y1,x2,y2, color, 90)
		--				nLog(x..","..y)
		--				wLog("WeSingFlowers", x..","..y)

		if x~=-1 and y~=-1 then
			return x,y
		end
		x,y= findTextWithX("dongren",107,205)

		if x~=-1 and y~=-1 then
			break
		end
		swipeDown3s()
	end
	swipeDownWithDeltaDu3s(y-218-100, 2000)

	for i=1,30 do
		x,y=findTextWithXY("dongren",110,218,205,373)
		if x~=-1 and y~=-1 then
			break
		end
		swipeDownLightly3s()
	end
	for j=1,5 do
		--		x, y = findTextWithXColor(text,x1,x2,color)
		x,y= tsFindText(addTSOcrDictEx(tab), text, x1,y1,x2,y2, color, 90)

		if x~=-1 and y~=-1 then
			return x,y
		end
		swipeRight3s()
	end
	return -1,-1
end

function findTextInRWZXwithTabColor(tab, text, color)
	return findTextInRWZXwithTabXYColor(tab,text,235,222,385,1750,color)
end

function findTextInRWZXwithTab(tab, text)
	return findTextInRWZXwithTabColor(tab,text,"2A2A2A , 010101")
end

function findTextInRWZXwithXColor(text, x1,x2, color)
	return findTextInRWZXwithTabXYColor(tab, text,x1,222,x2,1750,color)
end

--查找任务
function findRenWu(name)
	return findTextInRWZXwithTab(tab, name)
end

function sleep(t)
	for i=0,t,3 do
		mSleep(3000)
		toast("sleeped "..(i+3).." s, started "..(os.time()-start_time).." s",1)
	end
end

--启动全民k歌
function startQuanMingKGe()
	if 0~=runApp("com.tencent.karaoke") then
		dialog("启动全民k歌失败，程序退出")
	end
	sleep(20)
	click4s(972,1836)
end

--签到
function qianDao()
	enterRenWuZhongXin()
	--TODO: 判断是否弹出签到界面
	click4s(535,1362)
	nLog("签到完成")
	wLog("WeSingFlowers", "签到完成")
	exitRenWuZhongXin()
end

--收听作品
function shouTingZuoPin()
	local x,y
	enterRenWuZhongXin()
	x,y=findTextInRWZXwithTab({
			"1fffffffe003fffffffc007fffffff800e0000070001c00000e0003800001c00070000038000e0000070001c00000e0003800001c0007ffffff8000fffffff000000000000000000000000000000000020000000001e000000000f800000000fe00000003ff007fffffff000ffffffe0001fffff0000070070000000c00e0000001801c00000030038000000e0070000001c00e0000003001c00000060038000001c0070000003800e0000006001ffffffec003fffffff8007ffffffe000e000000c001c0000008003800000000070000000000e0000000001c0000000000000000000000000000000000000000000000000000000000000000000000000030000000000f0000000003c000000000f00000000078000000001f000000000ffffffffc07ffffffff83fffffffff1f800000000fc000000003e00000000070000000000000060000000003c000000000f0000000003c000000001e000000000f8000000007c000000003f000000001fc00000001ff800000003c70000000060e0000000001ffffffffe03ffffffffc07ffffffff80e0380700001c0700e0000380e01c0000701c0380000e0380700001c0700e0000380e01c0000701c0380000e0380700001c0700e0000380e01c0000701c0380000e0380700001c0000e00@000$tingzuo$914$43$89",
			},"tingzuo")
	if x~=-1 and y~=-1 then
		nLog("识别出的“收听作品”任务的位置："..x..", "..y)
		wLog("WeSingFlowers", "识别出的“收听作品”任务的位置："..x..", "..y)
		if isQianWang(929, y+deltaQianWang) then
			click2s(929,y+deltaQianWang)
			sleep(16*60)
			--			mSleep(3000)--fot test
			backward()
			x,y=findTextWithTabXYColor({
					"38000000387c0000007cfe000000feff000001ffff800003fe7fc00007fc3fe0000ff81ff0001ff00ff8003fe007fc007fc003fe00ff8001ff01ff0000ff83fe00007fc7fc00003feff800001ffff000000fffe0000007ffc0000003ff80000001ff00000000fe000000007c000000003800000000100000$>$326$40$24",
					},">", 210,222,300,1750,"2A2A2A,010101")
			if x~=-1 and y~=-1 then
				click2s(x,y)
				click2s(472,y)
			end
		end
	end
	exitRenWuZhongXin()
end

--观看签约直播间
retryCountQYZBJ=1 --用于计数重试次数
function watchQianYueZhiBoJian()
	local x,y,ytmp
	enterRenWuZhongXin()
	x,y=findRenWu("kanqian")
	if x~=-1 and y~=-1 then
		nLog("识别出的“观看签约直播间”任务的位置："..x..", "..y)
		wLog("WeSingFlowers", "识别出的“观看签约直播间”任务的位置："..x..", "..y)

		for i=1,10 do
			ytmp=y+deltaQianWang
			if isQianWang(929, ytmp) then
				if not clickQianWang(ytmp) then
					exitRenWuZhongXin()
					nLog("前往观看广告视频失败，即将进入递归")
					wLog("WeSingFlowers", "前往观看广告视频失败，即将进入递归")
					watchGuangGaoShiPing()
					return
				end
				sleep(11*60)
				--				mSleep(3000)--for test
				for j=1,5 do
					clickClose() --点击右上角的关闭图标
					x,y=findTextWithTabXYColor({
							"000000000002000007c00001c08001f00000fc30007c00007e1e001f00003f07c007c0001f81f801f00007c03f007c0003e007f01ffffff000fe07fffffc001f81ffffff0003e07fffffc00030000000f000000000001e000000000007c00000000000f000000000001e0000000001c78000000001fcf07ffffffffe3c1fffffffff8f07ffffffffe3c1fffffffff07878783c007c1e1e1e0f001f07878783c00781e1e1e0f001e07878783c00781e1e1e0f303c07878783cc0f01e1e1e0f783c07878783df0f01e1e1e0f3e7807878783c7c001e1e1e0f0f8007878783c3e001e1e1e0f07c007878783c3f801e1e1e0f0ff00787ffffc7fe01e1fffff3e7c0787ffffcf1f81e1fffff783f0f87fffffe07e3e000003f00f8f8000007801c3e000000e0020f800000100003e00000000000f800000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007ffff80000001ffffe00000007ffff807ffff1ffffe01ffffc7ffff807ffff00001e01ffffc00007800000f00001e000003c00007800000f00001e000003c00007800000f00001e000003c00007800000f00001e000003c00007800000f00001e000003c00007800000f00001e000003c000078fffffffffffe3fffffffffff8fffffffffffe3fffffffffff8fffffffffffe000003c00007800000f00001e000003c00007800000f00001e000003c00007800000f00001e000003c00007800000f00001e000003c00007800000f00001e000003c00007800000f00001e01ffffc00007807ffff00001e01ffffc7fffff07ffff1fffffc1ffffc7fffff0000001fffffc0000007fffff$tuichu$1838$50$100",
							},"tuichu", 275,1772,399,1844,"333333,010101")
					if x~=-1 and y~=-1 then
						click3s(x,y) --点击直接退出
						break
					end
				end
				if x==-1 then
					dialog("关闭签约直播间失败，请改善脚本或手动处理（关闭本对话框后3s内处理）")
					mSleep(3000)
				end
				mSleep(3000) --等待刷新
				if not clickLingQu(929,ytmp) then
					exitRenWuZhongXin()
					nLog("领取奖励失败，即将进入递归")
					wLog("WeSingFlowers", "领取奖励失败，即将进入递归")
					watchQianYueZhiBoJian()
					nLog("递归返回")
					wLog("WeSingFlowers", "递归返回")
					return
				end
			elseif isLingQu(929,ytmp) then
				click2s(929,ytmp) --点击领取
			else
				if retryCountQYZBJ>3 then
					break
				end
				exitRenWuZhongXin()
				nLog("第 "..retryCountQYZBJ.." 次重试")
				wLog("WeSingFlowers", "第 "..retryCountQYZBJ.." 次重试")
				retryCountQYZBJ=retryCountQYZBJ+1
				watchQianYueZhiBoJian()
				return
			end
			x,y=findText("kanqian")
			if x==-1 and y==-1 then 
				break
			end
		end
	end

	exitRenWuZhongXin()
end

--观看交友歌房
function watchJiaoYouGeFang()
	local x,y
	enterRenWuZhongXin()
	x,y=findRenWu("kanjiao")
	if x~=-1 and y~=-1 then
		nLog("识别出的“观看交友歌房”任务的位置："..x..", "..y)
		wLog("WeSingFlowers", "识别出的“观看交友歌房”任务的位置："..x..", "..y)
		if isQianWang(929, y+deltaQianWang) then
			click3s(929,y+deltaQianWang)
			sleep(11*60) 
			--			mSleep(3000)--for test
			clickClose()
			x,y=findTextWithTabXYColor({"000000040000000e0003800000070001c00040038001c0003001c000e0001800e00070000c007000300007ffffffffffffffffffffffffffffffffffff8007000e00000003800700000001c00300000000e003800000007001c0000000000000000000000000000000000e070000c0000703800060700381c000303801c0e000381c00e070201c0e007038780e0700381c7c0603981c0efe0301cf0e07f38380e3e703e0c180707383e070c03809c7e038e01c00eff00c618e0077380770f7003a1c01f03f801c0e00f807c00e07007801e00703803c00700381c03e003807c0e03f001c0fe0703fc00e1f70387ce0073e381dfc38039c1c0ff81c01cc0e07f00700e00703c003c0700381c000e03801c0e000381c00e070001c0e00703800040000381c000000001c0e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e00000700000700000783000380000783c001c0000780f000e00003803c00700003800f003800018003c01fffffc000f00fffffe0003807fffff000080000001800000000000e000000000003000000000000c000000000007000000000001800000000060e000000000f8707ffffffffc183ffffffffc0c1ffffffffe070e0e07000703870703800381c38381c00180e1c1c0e001c070e0e07000e03870703800601c38381c00300e1c1c0e3038070e0e071c1c03870703860001c38381c18000e1c1c0e0e00070e0e0703800387070380e001c38381c0f800e1c1c0e07e0070e0e0706700387ffff871c01c3ffffc30700e1ffffe381c070000003807838000003801c1c00000180040e000000400007000000000003800000000001@100$jietui$1386$49$103",
					},"jietui",715,1102,842,1185,"000000,010101")
			if x~=-1 and y~=-1 then
				click3s(x,y)
			end
		end
	end
	exitRenWuZhongXin()
end

--观看欢唱歌房
function watchHuanChangGeFang()
	local x,y
	enterRenWuZhongXin()
	x,y=findRenWu("kanhuan")
	if x~=-1 and y~=-1 then
		nLog("识别出的“观看欢唱歌房”任务的位置："..x..", "..y)
		wLog("WeSingFlowers", "识别出的“观看欢唱歌房”任务的位置："..x..", "..y)
		if isQianWang(929, y+deltaQianWang) then
			click3s(929,y+deltaQianWang)
			sleep(6*60)

			--关闭
			for i=1,5 do
				clickClose() --点击右上角的关闭图标
				x,y=findTextWithTabXYColor({
						"000002000000000001e00000000001fe0000000000ff00000000007f80000000003fc0000000001fc0000000001fe0000000000ff8000000000ffffffffff00ffffffffffc07ffffffffff0fffffffffffcffc000000000ffc0000000003fe0007c00000ff0001f000001c60007c0003e41e001f0000f8078007c0003e01e001f0000f80f8007c0003e03c001f0000f80f0007c0003e03c001f0000f80f0007c0003e03c001f0000f81f0007c0003e07c001f0000f81e0007c0003e078001f0000f81ffffffffffe07ffffffffff83ffffffffffe0fffffffffff83e0007c0003e0f0001f0000f87c0007c0003e1f0001f0000f8780007c0003e1e0001f0000f8f80007c0003e3e0001f0000f8f00007c0003e7c0001f0000f9f00007c0003e1c0001f0000f8200007c0003e000001f0000f8000007c0003e000001f00000000000000000000000000000000000000000000000000000000000004000000000003c00003000080f80000e000303e00003c001e0f0f801f000fc3c3e007c003e0f0f801e001f03c3e007800fc0f0f803e003e07c3e00f001f01e0f807c00fc0783e01e007e01e0f80f803fc0783e03c01ff03e0f81f00ffe0f03e0f80ff7c3c0f87e07fcf8f03e3f03ff1f7c0fbf80ffc3fe03ffc03df0ff80ffe00e7c1fe7ffe0011f03f1fff00007c0fc7ff00001f01f1ff800007c0787fe00001f03f00f800807c0fc03e003c1f07f80f800f07c1fe03e003c1f0ff80f800f07c3fe03e003c1f1f3c0f800f07c78f03e003c1f3e3c0f800f07df0f03e003c1ff83e0f800f07fc0783e007c1ff01e0f80fe07f80783e7ff81fc01e0ffffc07e00783fffe00f001f0fffc0010007c3ff00000001f0e0000000007c00000000000f000000000003c00000000000c000000$renwu$1838$50$104",
						},"renwu", 425,110,549,187,"2A2A2A,010101")
				if x~=-1 and y~=-1 then
					break
				end
			end
			if x==-1 then
				nLog("关闭欢唱歌房失败，请改善脚本或手动处理")
				wLog("WeSingFlowers", "关闭欢唱歌房失败，请改善脚本或手动处理")
				os.exit(false)
			end

			--TODO：识别文字
			click2s(362,674) --点击关闭后台播放
		end
	end
	exitRenWuZhongXin()
end

--看广告视频
function watchGuangGaoShiPing()
	local x,y,ytmp
	enterRenWuZhongXin()
	x,y=findRenWu("kanguang")
	if x~=-1 and y~=-1 then
		nLog("识别出的“看广告视频”任务的位置："..x..", "..y)
		wLog("WeSingFlowers", "识别出的“看广告视频”任务的位置："..x..", "..y)

		for i=1,8 do
			ytmp=y+deltaQianWang
			if isQianWang(929, ytmp) then
				if not clickQianWang(ytmp) then
					exitRenWuZhongXin()
					nLog("前往观看广告视频失败，即将进入递归")
					wLog("WeSingFlowers", "前往观看广告视频失败，即将进入递归")
					watchGuangGaoShiPing()
					return
				end
				sleep(20)

				clickCloseInGuangGao()
				mSleep(3000) --等待刷新
				if not clickLingQu(929,ytmp) then
					exitRenWuZhongXin()
					nLog("领取奖励失败，即将进入递归")
					wLog("WeSingFlowers", "领取奖励失败，即将进入递归")
					watchGuangGaoShiPing()
					nLog("递归返回")
					wLog("WeSingFlowers", "递归返回")
					return
				end
			elseif isLingQu(929,ytmp) then
				click2s(929,ytmp) --点击领取
			else
				break
			end
			x,y=findText("kanguang")
			if x==-1 and y==-1 then 
				break
			end
		end
	end
	exitRenWuZhongXin()
end

--领取所有未领取的奖励
function lingQuJiangLi()
	local x,y
	enterRenWuZhongXin()
	x,y=findTextInRWZXwithTabXYColor({
			"0006000000001e00000000f870000003e0e020000f81c0e0007e0380e001f00701e00f8e0e01e0fe1e1c03e1f81e381ff3f81f707df0780ce3e1e07801ff80c07803fc00007c07e000003c070000003e080004003800001c0000000039c00000007387ffffc1c70fffff878e1fffff1e1c3800003838700001e070e0001f80ffc3fffe01ff9ffff803ff3fff10078e0000700e1c0000701c380000f038700000f070fffff8f0e1fffff0f1c3ffffe0f380000000e0000000008000000000000000000000000000000000000401e000000e03c000001c07fffffff80ffffffff01fffffffe03fffffff80781c0e0700f0381c0e01e070381c03c0e070780781c0e0e00f0381c1c01fffffffffbfffffffff7ffffffffefffffffffde000007003c00000e007800001c081e0000003c3c000000f07f000003e0fff0000781fffe003e03c7ff80f807807fc3e00f001fff801e0007fc003c0007f80078003ffc00f003fcfc01e03fe07c03c7ff007c07fff0007c0fff00007c0fc00000780000000070000000004$lingqu$1214$39$80",
			},"lingqu", 832,193,1025,1750, "FFFFFF,010101")
	if x~=-1 and y~=-1 then
		for j=1,8 do
			x,y=findTextWithTabXYColor({
					"0006000000001e00000000f870000003e0e020000f81c0e0007e0380e001f00701e00f8e0e01e0fe1e1c03e1f81e381ff3f81f707df0780ce3e1e07801ff80c07803fc00007c07e000003c070000003e080004003800001c0000000039c00000007387ffffc1c70fffff878e1fffff1e1c3800003838700001e070e0001f80ffc3fffe01ff9ffff803ff3fff10078e0000700e1c0000701c380000f038700000f070fffff8f0e1fffff0f1c3ffffe0f380000000e0000000008000000000000000000000000000000000000401e000000e03c000001c07fffffff80ffffffff01fffffffe03fffffff80781c0e0700f0381c0e01e070381c03c0e070780781c0e0e00f0381c1c01fffffffffbfffffffff7ffffffffefffffffffde000007003c00000e007800001c081e0000003c3c000000f07f000003e0fff0000781fffe003e03c7ff80f807807fc3e00f001fff801e0007fc003c0007f80078003ffc00f003fcfc01e03fe07c03c7ff007c07fff0007c0fff00007c0fc00000780000000070000000004$lingqu$1214$39$80",
					},"lingqu", 832,193,1025,1750, "FFFFFF,010101")
			if x~=-1 and y~=-1 then
				click2s(x,y)
			else
				swipeDown3s()
			end
		end
	end
	nLog("奖励领取完毕")
	wLog("WeSingFlowers", "奖励领取完毕")
	exitRenWuZhongXin()
end

tab = {
"0000180000000001f0000000001f8000000001f8000000003f8000000003f8000000003f8000000007fc000000007ffffffff80fffffffffc1fffffffffe3fe00000000ff8000000007f8003c00003f8001e00000c7000f0003c03c0078001e01e003c000f00e001e0007807000f0003c0780078001e03c003c000f01e001e000780f000f0003c0780078001e038003c000f03c001e000781fffffffffc0fffffffffe07fffffffff03fffffffff83c000f0003c1e00078001e0f0003c000f078001e0007878000f0003c3c00078001e1e0003c000f1f0001e00078f0000f0003c3800078001e0c0003c000f000001e0007800000f0003c000007800000000000000000000000000000000000000000000000000000040000200000380001800103c0000f000c1e00007800f0f0f007800f8787803c00783c3c01e007c1c1e01e007c0e0f00f007c0f0780f803e0783c07803f03c1e07c03fc1c0f03c07ff1e0783c07f78f03c3c07f9e781e7e07fc7b80ffe03fe1fc07fe01cf0fe1ffc008783e3ffc0003c1f1ff80001e078ff80000f03c73c0000783e01e00403c1f00f00381e1fc07801c0f0fe03c00e078ff01e00703c7bc0f00381e79e07801c0f38f03c00e07bc381e00703fc1c0f00381fc0f07807c0fc0783c3fe07e03c1fffe03e01e0fffe01c00f07ff800400383f80000001c0000000000f000000000078000000000300000000001000000@0$renwu$1369$45$93",
"0001800300000018003000000180070000001800e0001061801c0001061803800010618070000106180e0000106181c0000106183c000010618ffffff1061dffffff1061ff1c70e3061f30c30c3067c30c30c307fc30c30c31fd830c30c3ff1830c30c3fe1830c30c3c61830c30c3061830c30c3061830c30c3061830c30c3061830c30c3061830c30c3061830c30c3061830c30c2061830c30c6061830c30c6061830c30c6061830c30c6061830c30c6061830c30c6061830c30c606183fffff406183fffff406183fffff0061800000000618000000000180000000001800000000018000000000000000000000000000000000000000000000000000000000000000000000000001801000000038038000e00f0030000e01e0070000e0780060000e1f00060000efe000e0800efc000c0c00e0e001c0f00e0e001803c0e0f803801f0e0ff0300078e0e78770010e0c10e70000e0c00c70000e0c01c70000e0c01870000e0c03070000e0c06071000e000c071c00e009c070f00e03fc0703e0e079c0700f0e1e06070020e7e03070000efc01870000ecc01870000e0c00c70003e0e00670007e0e0067001fe0f0030007ce0fc03001f0e0ef01807c0e0c78181f00e0c100c1c00e0c000c1000e0c000e0000e0c00060000e0c00070000e0c00070000e0c00030000e$kanqian$1058$44$89",
"0001800300000018003000000180070000001800e0001061801c0001061803800010618070000106180e0000106181c0000106183c000010618ffffff1061dffffff1061ff1c70e3061f30c30c3067c30c30c307fc30c30c31fd830c30c3ff1830c30c3fe1830c30c3c61830c30c3061830c30c3061830c30c3061830c30c3061830c30c3061830c30c3061830c30c3061830c30c2061830c30c6061830c30c6061830c30c6061830c30c6061830c30c6061830c30c6061830c30c606183fffff406183fffff406183fffff00618000000006180000000001800000000018000000000180000000000000000000000000000000000000000000000000000000000000000000000000000000000401c0000000601c0060000701c00e0000601c00e0000e01c01c0000e01c0380000c01c0700001c01c0e00001c01c1e00001801c3c00003801c7800003801cf070007001c6078007001c001e00e001c000780e001c0003c1c001c0000e380c1c00007380f1c00003f00fdc00001e003fc00001e000dc00003f0001c00007b0001c0000f38001c0003c1c001c000780c001c001f00e001c40fc006001ce070007001c7040003001c3800003801c1800001801c1c00001c01c0e00001c01c0700000c01c0380000e01c01c0000e01c01e0000e01c00e0000601c00000006$kanjiao$950$44$89",
"0001800300000018003000000180070000001800e0001061801c0001061803800010618070000106180e0000106181c0000106183c000010618ffffff1061dffffff1061ff1c70e3061f30c30c3067c30c30c307fc30c30c31fd830c30c3ff1830c30c3fe1830c30c3c61830c30c3061830c30c3061830c30c3061830c30c3061830c30c3061830c30c3061830c30c3061830c30c2061830c30c6061830c30c6061830c30c6061830c30c6061830c30c6061830c30c6061830c30c606183fffff406183fffff406183fffff00618000000006180000000001800000000018000000000180000000000000000000000000000000000000000000000000000000000000000000000200700000007007060000070070700001e00703c0003c00700e00078007007800f0007003c03c0007000f07800070007de000070001fc000070003f800007001ffe00007007f0f800070ff803e0007ffc001f0007fc0000600038000000060000000000e0000400001c0001e00003c0007e000078001f80000f001fc00001e07ff000003c0ffc00000f0061c00003e0001c0001f80001c007fe00001c3fff000001c3fff000001c003fc00001c0003f00001c00007c0001c00001f0001c000007c001c000001e001c000000f001c1800003801dfc00001c01fe000001e00f0000000e00000000006$kanhuan$999$44$90",
"0001800300000018003000000180070000001800e0001061801c0001061803800010618070000106180e0000106181c0000106183c000010618ffffff1061dffffff1061ff1c70e3061f30c30c3067c30c30c307fc30c30c31fd830c30c3ff1830c30c3fe1830c30c3c61830c30c3061830c30c3061830c30c3061830c30c3061830c30c3061830c30c3061830c30c3061830c30c2061830c30c6061830c30c6061830c30c6061830c30c6061830c30c6061830c30c6061830c30c606183fffff406183fffff406183fffff0061800000000618000000000180000000001800000000018000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000001f000000000fe000000007f801fffffffe001fffffff0001fffffe00001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000041c00000000f1c00000000ffc000000003fc0000000005c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c0000000001c00000000$kanguang$793$44$89",
"0001c0000000001c0003800e01c0007800e01c003f800e01c01ff000e01c0fe3000e01cff07000e01ff807000e01fc006000e01c0006000e01c0006000e01c000e000e01c000e000e01c000c000e01c000c000e01c1c0c000e01c0f9c000e01c03f8000e01c007e000001c001f00000000003040000000000e001c000003c001c0000078001c00003f0001c0000fc0001c0007f00001c00ffc00001ffffe0007fffffe000c7ffff00000e001c000000e001c000000e001c000000e001c000000e001c000000e001c000000e001c000007c001c000fff8001fffffff0001fffffe00001fc00000000000000000000000000000000000000000000000000000000000000000100000000003c00000000078000000000f0000000001e0000000007c000000000f0000000003f000000000fffffffff01fffffffff07c000000001f000000000fc00000000070000700000400007000000300070001c0380070001c0300070001c0300070001c0300070001c0300070001c0700070001c0700070001c0700070001c0600070001c0600070001c0600070001c0fffffffffc0fffffffffc0fffffffffc0c00070001c0c00070001c1c00070001c1c00070001c1800070001c1800070001c3800070001c3800070001c3000070001c3000070001c1000070001c0000070001c$dongren$908$44$89",
}
deltaQianWang=40
start_time=os.time()
initLog("WeSingFlowers", 0)

--主函数
function main()
	startQuanMingKGe()
	qianDao() --几秒钟，平均5朵
	watchHuanChangGeFang() --5分钟，10朵
	watchGuangGaoShiPing() --15*5秒，10*5朵
	watchQianYueZhiBoJian() --10*3分钟，10*3朵
	watchJiaoYouGeFang() --10分钟，10朵
	shouTingZuoPin() --15分钟，10朵鲜花
	lingQuJiangLi() --总计62分钟，115朵
	nLog("cost "..(os.time()-start_time).." s")
	wLog("WeSingFlowers", "cost "..(os.time()-start_time).." s")
end

--用于测试的函数
function test()
--	nLog(os.time())
--	wLog("WeSingFlowers", os.time())

--	findTextInRWZXwithTab({
--			"1fffffffe003fffffffc007fffffff800e0000070001c00000e0003800001c00070000038000e0000070001c00000e0003800001c0007ffffff8000fffffff000000000000000000000000000000000020000000001e000000000f800000000fe00000003ff007fffffff000ffffffe0001fffff0000070070000000c00e0000001801c00000030038000000e0070000001c00e0000003001c00000060038000001c0070000003800e0000006001ffffffec003fffffff8007ffffffe000e000000c001c0000008003800000000070000000000e0000000001c0000000000000000000000000000000000000000000000000000000000000000000000000030000000000f0000000003c000000000f00000000078000000001f000000000ffffffffc07ffffffff83fffffffff1f800000000fc000000003e00000000070000000000000060000000003c000000000f0000000003c000000001e000000000f8000000007c000000003f000000001fc00000001ff800000003c70000000060e0000000001ffffffffe03ffffffffc07ffffffff80e0380700001c0700e0000380e01c0000701c0380000e0380700001c0700e0000380e01c0000701c0380000e0380700001c0700e0000380e01c0000701c0380000e0380700001c0000e00@000$tingzuo$914$43$89",
--			},"tingzuo")
--	nLog(x..","..y)
--	wLog("WeSingFlowers", x..","..y)

--	sleep(10)

	for i=1,5 do 
		swipeDown3s()
	end

--swipeDown3s()

--	startQuanMingKGe()
--	qianDao()
--	shouTingZuoPin()
--	watchQianYueZhiBoJian()
--	watchJiaoYouGeFang()
--	watchHuanChangGeFang()
--	watchGuangGaoShiPing()
--	lingQuJiangLi()

--	nLog(isQianWang(929,427))
--	wLog("WeSingFlowers", isQianWang(929,427))
end

--test()
main()

closeLog("WeSingFlowers");                   --关闭日志

